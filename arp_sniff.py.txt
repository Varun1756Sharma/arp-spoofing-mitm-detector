from scapy.all import sniff, ARP

print("Listening for ARP packets... Press CTRL+C to stop")

def arp_monitor(packet):
    if packet.haslayer(ARP):
        arp = packet[ARP]
        print(f"[ARP] {arp.psrc} -> {arp.hwsrc}")

sniff(filter="arp", prn=arp_monitor, store=False)

